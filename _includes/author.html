{%- for author in entry.author_array -%}
{%- assign author_is_self = false -%}
{%- if author.last == site.scholar.last_name%}
{%- if site.scholar.first_name contains author.first -%}
{%- assign author_is_self = true -%}
{%- endif -%}
{%- endif -%}
{%- assign coauthor_url = nil -%}
{%- if site.data.coauthors[author.last] -%}
{%- for coauthor in site.data.coauthors[author.last] -%}
{%- if coauthor.firstname contains author.first -%}
{%- assign coauthor_url = coauthor.url -%}
{%- break -%}
{%- endif -%}
{%- endfor -%}
{%- endif -%}

{%- if forloop.length == 1 -%}
{%- if author_is_self %}
<strong>{{author.last}}, {{author.first}}</strong>
{%- else -%}
{{author.last}}, {{author.first}}
{%- endif -%}
{%- else -%}
{%- unless forloop.last -%}
{% if author_is_self %}
<strong>{{author.last}}, {{author.first}}</strong>,&nbsp;
{%- else -%}
{% if coauthor_url -%}
<a href="{{coauthor_url}}">{{author.last}}, {{author.first}}</a>,&nbsp;
{%- else -%}
{{author.last}}, {{author.first}},&nbsp;
{%- endif -%}
{%- endif -%}
{%- else -%}
{% if author_is_self -%}
& <strong>{{author.last}}, {{author.first}}</strong>
{% else -%}
{%- if coauthor_url -%}
& <a href="{{coauthor_url}}">{{author.last}}, {{author.first}}</a>
{% else -%}
& {{author.last}}, {{author.first}}
{%- endif -%}
{%- endif -%}
{%- endunless -%}
{%- endif -%}
{%- endfor %}